{% extends "layout.html" %}

{% block title %}Verification{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">Helper Verification</h4>
                </div>
                <div class="card-body">
                    {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                    {% for category, message in messages %}
                    <div class="alert alert-{{ category }}" role="alert">
                        {{ message }}
                    </div>
                    {% endfor %}
                    {% endif %}
                    {% endwith %}

                    {% if verification %}
                    <div class="verification-status mb-4">
                        <h5>Verification Status: <span
                                class="badge {% if verification.status == 'Approved' %}bg-success{% elif verification.status == 'Rejected' %}bg-danger{% else %}bg-warning{% endif %}">{{
                                verification.status }}</span></h5>

                        {% if verification.status == 'Pending' %}
                        <div class="alert alert-info">
                            <p>Your verification is currently under review. This process typically takes 1-3 business
                                days. You'll be notified once the review is complete.</p>
                        </div>
                        {% elif verification.status == 'Rejected' %}
                        <div class="alert alert-danger">
                            <p><strong>Reason for rejection:</strong> {{ verification.notes or 'Your documents did not
                                meet our verification requirements.' }}</p>
                            <p>Please submit new documents addressing the issues mentioned above.</p>
                        </div>
                        <hr>
                        <h5>Submit New Documents</h5>
                        <form action="{{ url_for('helper.submit_verification') }}" method="post"
                            enctype="multipart/form-data">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                            <div class="mb-3">
                                <label for="id_document" class="form-label">Government-issued ID</label>
                                <input type="file" class="form-control" id="id_document" name="id_document" required>
                                <div class="form-text">Please upload a clear image of your government-issued ID
                                    (passport, driver's license, etc.)</div>
                            </div>
                            <div class="mb-3">
                                <label for="certificate" class="form-label">Professional Certificate or
                                    Qualification</label>
                                <input type="file" class="form-control" id="certificate" name="certificate" required>
                                <div class="form-text">Please upload any relevant professional certificates or
                                    qualifications related to your skills</div>
                            </div>
                            <button type="submit" class="btn btn-primary">Submit Documents</button>
                        </form>
                        {% elif verification.status == 'Approved' %}
                        <div class="alert alert-success">
                            <p>Your account has been verified! You can now accept service requests from users.</p>
                        </div>
                        {% endif %}
                    </div>
                    {% else %}
                    <div class="verification-intro mb-4">
                        <h5>Get Verified</h5>
                        <p>To ensure the safety and trust of our community, all helpers must be verified before
                            accepting service requests. Please submit the following documents:</p>
                        <ul>
                            <li>A government-issued ID (passport, driver's license, etc.)</li>
                            <li>Any professional certificates or qualifications related to your skills</li>
                        </ul>
                    </div>

                    <form action="{{ url_for('helper.submit_verification') }}" method="post"
                        enctype="multipart/form-data">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                        <div class="mb-3">
                            <label for="id_document" class="form-label">Government-issued ID</label>
                            <input type="file" class="form-control" id="id_document" name="id_document" required>
                            <div class="form-text">Please upload a clear image of your government-issued ID (passport,
                                driver's license, etc.)</div>
                        </div>
                        <div class="mb-3">
                            <label for="certificate" class="form-label">Professional Certificate or
                                Qualification</label>
                            <input type="file" class="form-control" id="certificate" name="certificate" required>
                            <div class="form-text">Please upload any relevant professional certificates or
                                qualifications related to your skills</div>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit Documents</button>
                    </form>
                    {% endif %}
                </div>
            </div>

            <div class="card shadow mt-4">
                <div class="card-header bg-info text-white">
                    <h4 class="mb-0">Verification FAQ</h4>
                </div>
                <div class="card-body">
                    <div class="accordion" id="verificationFAQ">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingOne">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                    Why do I need to be verified?
                                </button>
                            </h2>
                            <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                                data-bs-parent="#verificationFAQ">
                                <div class="accordion-body">
                                    Verification helps ensure the safety and trust of our community. By verifying your
                                    identity and qualifications, users can feel confident when requesting your services.
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                    How long does verification take?
                                </button>
                            </h2>
                            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                                data-bs-parent="#verificationFAQ">
                                <div class="accordion-body">
                                    Verification typically takes 1-3 business days. You'll be notified via email and on
                                    your dashboard once the review is complete.
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingThree">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                    What if my verification is rejected?
                                </button>
                            </h2>
                            <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree"
                                data-bs-parent="#verificationFAQ">
                                <div class="accordion-body">
                                    If your verification is rejected, you'll be provided with a reason. You can submit
                                    new documents addressing the issues mentioned. Common reasons for rejection include
                                    unclear images, expired documents, or missing information.
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingFour">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                    How is my data protected?
                                </button>
                            </h2>
                            <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour"
                                data-bs-parent="#verificationFAQ">
                                <div class="accordion-body">
                                    Your documents are stored securely and are only accessible to our verification team.
                                    We do not share your personal information with other users or third parties. Your
                                    data is handled in accordance with our privacy policy.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Add any verification-specific JavaScript here
</script>
{% endblock %}